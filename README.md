Crop Disease Detection & Yield Prediction
This project implements a deep learning pipeline to detect plant leaf diseases across multiple crop types and predict the quantitative yield loss, fulfilling the advanced requirements for the Longathon AI/ML project.

Project Goal
The primary goal is to provide an end-to-end system that performs:

1. Multi-Class Classification: Identifying one of 22 disease/healthy classes using transfer learning models (DenseNet-121).

2. Regression Analysis: Estimating potential yield loss percentage using a Random Forest Regressor.



Setup and Installation

A. Environment Setup (Critical)
This project requires a specific Python environment because modern Streamlit and older TensorFlow versions conflict. We use a Conda environment to guarantee compatibility.

1. Install Conda: Download and install Miniconda.

2. Create Environment: Open your Anaconda Prompt and execute the following command to create a stable environment with Python 3.10:
   - Bash:
         conda create -n tf_crop_env python=3.10
    
3. Activate Environment:
   - Bash:
         conda activate tf_crop_env

4. Install Dependencies: Install the required libraries inside the new environment. (This uses specific versions known to work together).
   - Bash:
         pip install tensorflow==2.10.0 numpy==1.23.5 pandas scikit-learn matplotlib seaborn joblib streamlit==1.25.0 pillow
  
   
B. Project Structure
Project requires the following folders in the root directory:

re-ai/
├── data/           # Contains datasets (train/test folders)
├── models/         # Stores trained models (.h5, .joblib)
├── src/            # Contains all executable Python scripts
├── figures/        # Stores result images (Confusion Matrix)
├── app.py          # The main Streamlit web application
└── README.md


Running the Project (For Evaluation)
The models have been trained on a large, combined dataset (PlantVillage + Apple + Coffee), and the weights are stored locally.

1. Verification of Trained Models
The following files must be present in the /models directory for the system to run:
    - DenseNet121_best.h5
    - rf_regressor.joblib (Random Forest model)

2. Launching the Web Application (Demonstration)
To run the final, interactive demonstration required for evaluation, execute the Streamlit app from the project root:

    - Activate Environment:
          conda activate tf_crop_env
    - Navigate to Root:
          cd path/to/your/re-ai
    - Run Application:
            streamlit run app.py
      The application will open in your browser (http://localhost:8501).

How the Prediction Works:
The app.py script performs a two-stage process:

1. Diagnosis: The uploaded leaf image is passed to the DenseNet-121 model to determine the Predicted Class (e.g., Tomato Bacterial Spot) and Confidence.

2. Regression: The output (Confidence and Predicted Crop Type) is fed into the Random Forest Regressor to predict the final Potential Yield Loss (%).


Evaluation and Metrics
All final performance metrics and plots are generated by running the scripts located in the /src directory.

Final Classification Metrics
To verify the classification results used in Section 6.1 of the report:
    - Navigate: 
        cd src
    - Run Evaluation: (Enter DenseNet121 when prompted)
        python evaluate_clf.py
    (This generates the Confusion Matrix image: figures/cm_DenseNet121.png)

Final Regression Metrics
To verify the yield prediction results used in Section 6.2 of the report:

1. Navigate:
       cd src
   
2.Run Regressor:
    - Bash:
        python train_regressor.py
(This prints MSE, RMSE, R², and MAE to the console)
